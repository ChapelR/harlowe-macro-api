// dice.min.js, for Harlow Macro API, by Chapel
;!function(){"use strict";var m=/(\d+)d(\d+|f)(\s*([+-])\s*(\d+))?/i,d=["roll","amount","type","mod_whole","mod_sign","mod_value"];function a(r,e,n,t){var o=function(r,e,n){n&&"function"==typeof n||(n=Math.random);var t=1,o=0,i=[];if(r=Number(r),"string"==typeof e&&"F"===e.trim().toUpperCase()?(e=3,t=-1):e=Number(e),[r,e,t].some(function(r){return Number.isNaN(r)}))throw new TypeError("could not process arguments in dice roll");for(var u=0;u<r;u++){var f,m=n();if("number"!=typeof m||1<m||m<0)throw new TypeError("invalid random function--should return a value between 0 and 1");f=Math.floor(m*e)+t,i.push(f),o+=f}return{rolls:i,result:o}}(r,e,t).result;return n&&(o+=n),o}function o(r,e,n){var t,o,i,u,f={};return"string"==typeof r?(t=function(r){if(r&&"string"==typeof r){var e=r.trim().toLowerCase();if(e&&e.includes("d")){var n=m.exec(e);if(n&&n instanceof Array&&n.length){var t={};return d.forEach(function(r,e){t[r]=n[e]||""}),t}}}}(r),o=Number(t.amount),i=Number(t.type),u=Number(t.mod_value),"-"===t.mod_sign.trim()&&(u*=-1),f={number:o,type:i,modifier:u}):(f.number=r,f.type=e),!f.modifier&&n&&"number"==typeof n?f.modifier=n||0:f.modifier||(f.modifier=0),a(f.number,f.type,f.modifier,null)}Harlowe.macro("dice",function(r,e,n){var t=this.typeCheck(["string|number","number|undefined","number|undefined"]);if(t)throw t;return o(r,e,n)}),window.setup=window.setup||{},Object.assign(window.setup,{dice:o})}();
// end dice.min.js